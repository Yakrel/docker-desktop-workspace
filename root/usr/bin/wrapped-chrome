#!/bin/bash

BIN=/usr/bin/google-chrome
CONFIG_DIR="$HOME/.config/google-chrome"

# Ensure config dir exists
mkdir -p "$CONFIG_DIR"

# Aggressive cleanup of lock files (fixes "Chrome won't open" issue)
rm -f "$CONFIG_DIR/SingletonLock" "$CONFIG_DIR/SingletonCookie" "$CONFIG_DIR/SingletonSocket" 2>/dev/null

# Kill zombie chrome processes if any
pkill -9 -f "chrome.*zombie" 2>/dev/null || true

${BIN} \
  --no-first-run \
  --no-sandbox \
  --password-store=basic \
  --simulate-outdated-no-au='Tue, 31 Dec 2099 23:59:59 GMT' \
  --start-maximized \
  --test-type \
  --user-data-dir="$CONFIG_DIR" \
  --disable-dev-shm-usage \
  --disable-background-networking \
  --enable-gpu-rasterization \
  --enable-zero-copy \
  --ignore-gpu-blocklist \
  "$@"
